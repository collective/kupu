==============
TODO for Plone
==============

[also some general todos. Some of these are firm ideas, others are
just idle thoughts]

Make the toolbar customisable from Plone control panel, possibly by
making the kupu tool into an action provider.
[DB: I'm not sure this will work as I think the information we need is
rather different than the usual action provider. After all, our
actions are all client side javascript not server-side methods.
However the general idea is good.]

Make the initialisation data driven so it can be more easily
customised (and driven from plone cpanel.

Add user-level documentation to kupu.oscom.org. Make the Plone
butterfly direct to a plone specific documentation page?

Improved source editing mode? At the least we should apply the content
filtering when switching into source mode.

Need a pulldown to set classes on non-block tags: e.g. span, a, etc.

Make the ul/li pulldown options customisable through cpanel, allow
them to set classes as well as list-style-type.

Refactor classes to do proper base class initialisation. This also
means we need to use .prototype. consistently for methods.

Move Plone paragraph styling back into the common code.

Generic RPC mechanism to allow tools to be defined entirely on the
server?? JSON-RPC?

Triage on the issue tracker: which issues are still valid, which are
fixed or otherwise outdated, which do we fix and which are unfixable.

Make it easier to enable the output transforms. Hotfix ATCT?

====================
Backport into common
====================
Merge PloneKupuUI class back into common so that other variants of
kupu can support classnames on styles.

Code to make links relative should also be shareable.

Collapse saveDataField and prepareForm together:

-  Maybe make _serializeOutputToString use config to select body or
   full html.

-  prepareForm should accept field name or field object and only
   create output field if it doesn't already exist.

-  makeLinksRelative should accept configurable pattern for URLs which
   are to lose their path completely. For Plone this should default to
   resolveuid.

================
TODO for drawers
================

These are probably core issues rather than specifically Plone.

- image drawer should go straight to the correct location when opened
  on an existing image (is this even possible?) so you can adjust
  alignment, captioning etc. without having to reinsert the image.

- add toolbox drawer to run macros which aren't deemed important
  enough to be directly on the toolbar.

- Uploading an image doesn't let you float the image. Perhaps the
  upload handler should simply refresh the drawer with the uploaded
  file selected, then you can set all the usual image options on an
  uploaded image.

And a Plone one:

- Want an Archetypes widget which uses Kupu drawers so we can easily
  incorporate them into reference pickers etc. This should be easier
  now we have multi-instance Kupu as we no longer need to care whether
  or not there is already a Kupu on the page.

=====================
IE problems and fixes
=====================

o importNode(node) fails on XML Document nodes. Use
  node.cloneNode(true) as a hack.

o drawer changes height when navigating with IE. Fixed by forcing the
  entire drawer to refresh in IE, but there must be something simpler we
  could do to have the same effect.

